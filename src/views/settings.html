<div>
  <form name="settings">
    <div class="row">
      <div class="col-lg-6">
        <h2 class="mb-3">Configuration File Options</h2>
        <ul class="list-group">
          <div id="config">Loading...</div>
          <li class="list-group-item d-flex">
            <div class="flex-1">
              <label class="mb-1">Last Updated on:</label>
              <div id="settings_lastConfigUpdate"></div>
              <div
                class="text-danger"
                id="settings_lastConfigUpdateError"
              ></div>
            </div>
            <div>
              <button
                type="button"
                class="btn btn-success"
                id="settings_refreshNow"
              >
                <i class="fas fa-sync"></i> Update Now
              </button>
            </div>
          </li>
        </ul>
      </div>

      <div class="col-lg-6">
        <h2 class="mb-3">Search Results Options</h2>
        <div id="search-results">Loading...</div>
      </div>
    </div>
    <div class="row">
      <div class="col-md-6">
        <h2 class="mb-3 mt-4">Merge Settings Options</h2>
        <div id="merge-options">Loading...</div>
      </div>
    </div>

    <script id="template_generic-settings" type="x-tmpl-mustache">
      {{#items}}
        {{!-- The checkbox fields --}}
        {{#isCheckbox}}
          <li class="list-group-item">
            <div class="form-check">
              <input
                type="checkbox"
                class="form-check-input"
                name="{{key}}"
                id="settings_{{key}}"
              />
              <label class="form-check-label" for="settings_{{key}}">
                {{label}}
              </label>
            </div>
          </li>
        {{/isCheckbox}}

        {{!-- The input fields --}}
        {{#isInput}}
          <li class="list-group-item">
            <div class="form-group mb-0">
              <label class="mb-1" for="settings_{{key}}"
                >{{label}}</label
              >
              <input
                type="text"
                class="form-control"
                name="{{key}}"
                id="settings_{{key}}"
              />
            </div>
          </li>
        {{/isInput}}

        {{!-- The dropdown fields --}}
        {{#isDropdown}}
          <li class="list-group-item">
            <span class="dropdown">
              <button class="btn btn-outline-dark dropdown-toggle" type="button" name="{{key}}" id="settings_{{key}}" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                {{value}}
              </button>
              <div class="dropdown-menu" tabindex="1" aria-labelledby="settings_{{key}}">
                {{#menuItems}}
                  <button class="dropdown-item" name="{{key}}" value="{{index}}">{{.}}</button>
                {{/menuItems}}
              </div>
            </span>
            <label class="form-check-label">
              {{label}}
            </label>
            <a data-placement="right" data-toggle="tooltip" data-title="<div class='text-left'><div><strong>Merge:</strong> Adds search providers that aren't already in current list of search providers.</div><div><strong>Override:</strong> Replaces local search providers with new settings.</div><div><strong>Ignore:</strong> Keeps current list and ignores any incoming changes.</div></div>"><i class="fas fa-info-circle text-info" aria-hidden="true"></i></a>
          </li>
        {{/isDropdown}}
      {{/items}}
    </script>
  </form>

  <div class="row">
    <div class="col-md-10 offset-md-1">
      <h2 class="text-center mt-3">Export/Import Search Options</h2>

      <p>
        Use Import and Export to share settings using a file. Otherwise, click
        Edit to modify the settings manually. This requires knowing JSON
        formatting well. We also recommend exporting a copy of your settings
        prior to doing this.
      </p>

      <input class="d-none" id="settings_fileInput" type="file" />

      <div class="text-right">
        <button type="button" class="btn btn-primary mr-2" id="settings_import">
          <i class="fas fa-file-import" aria-hidden="true"></i> Import
        </button>
        <button type="button" class="btn btn-primary mr-2" id="settings_export">
          <i class="fas fa-file-export" aria-hidden="true"></i> Export
        </button>
        <button type="button" class="btn btn-secondary" id="settings_edit">
          <i class="fas fa-edit" aria-hidden="true"></i> Edit manually
        </button>
      </div>
    </div>
  </div>

  <div
    class="modal fade"
    id="settings_editModal"
    tabindex="-1"
    role="dialog"
    aria-labelledby="settingsEditModal"
    aria-hidden="true"
  >
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Edit Changes</h5>
          <button
            type="button"
            class="close"
            id="settings_closeModal"
            aria-label="Close"
          >
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <textarea
            id="settings_json"
            class="form-control text-monospace text-small"
            rows="24"
          >
          </textarea>
        </div>
        <div class="modal-footer">
          <button
            type="button"
            class="btn btn-secondary"
            id="settings_discardChanges"
          >
            Discard
          </button>
          <button
            type="button"
            class="btn btn-success mr-2"
            id="settings_saveChanges"
          >
            Save changes
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
